{
  "hash": "8ded9819be9af2a04481d40dfd3a7282",
  "result": {
    "markdown": "---\naliases:\n  - ejercicio-semana12b.html\n---\n\n\n\n\nCo-author: Luis Valverde\n\n# Regresión Lineal II\n\n\n- Pavimentando con votos\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#getwd() \n#setwd(\"\")\nlibrary(\"rio\")\ndataPAVI = import(\"./data/s12/b-pavimentando con votos.sav\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#names(dataPAVI)\n#str(dataPAVI)\n```\n:::\n\n\n## Formateo: DISTINGAMOS LAS VARIABLES NUMERICAS Y (NOMINALES) DICOTOMICAS\n\n::: {.cell}\n\n```{.r .cell-code}\n# forma corta\ndataPAVI[,c(1:2, 5, 7:8)] = lapply(dataPAVI[,c(1:2, 5, 7:8)],as.numeric)\ndataPAVI[,c(3:4, 6)] = lapply(dataPAVI[,c(3:4, 6)],as.factor)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# forma larga\n#dataPAVI$poblacioncienmil = as.numeric(dataPAVI$poblacioncienmil)\n#dataPAVI$nbi = as.numeric(dataPAVI$nbi)\n\n#dataPAVI$consejocomunal = as.factor(dataPAVI$consejocomunal)\n#dataPAVI$priorizado = as.factor(dataPAVI$priorizado)\n\n#dataPAVI$uribista = as.numeric(dataPAVI$uribista)\n\n#dataPAVI$ejecucion = as.factor(dataPAVI$ejecucion)\n\n#dataPAVI$apropiaciondolar = as.numeric(dataPAVI$apropiaciondolar)\n#dataPAVI$pctopo = as.numeric(dataPAVI$pctopo)\n```\n:::\n\n\n**Si la variable independiente es numérica**\n============================================================\n  - HIPOTESIS: La asignación presupuestal se explica por el indicador de necesidades básicas insatisfechas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo1 = lm(apropiaciondolar ~ nbi, data = dataPAVI)\nsummary(modelo1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = apropiaciondolar ~ nbi, data = dataPAVI)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-14.426  -9.326  -5.943   1.937 118.822 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 15.27938    1.22247  12.499  < 2e-16 ***\nnbi         -0.15924    0.02609  -6.103 1.46e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15.92 on 1064 degrees of freedom\n  (30 observations deleted due to missingness)\nMultiple R-squared:  0.03382,\tAdjusted R-squared:  0.03291 \nF-statistic: 37.25 on 1 and 1064 DF,  p-value: 1.455e-09\n```\n:::\n:::\n\n\n\nPr(>|t|) <- 1.46e-09 \n\n\n\n\n\n\n\n**Si la variable independiente es categórica (dicotómica)**\n============================================================\n  - HIPOTESIS: La asignación presupuestal se debe a criterios técnicos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo2 = lm(apropiaciondolar ~ priorizado, data = dataPAVI)\nsummary(modelo2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = apropiaciondolar ~ priorizado, data = dataPAVI)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n -8.277  -8.277  -8.272   1.108 124.371 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  8.277427   0.560554  14.766   <2e-16 ***\npriorizado1 -0.005434   1.117040  -0.005    0.996    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.05 on 1094 degrees of freedom\nMultiple R-squared:  2.163e-08,\tAdjusted R-squared:  -0.0009141 \nF-statistic: 2.367e-05 on 1 and 1094 DF,  p-value: 0.9961\n```\n:::\n:::\n\n\n\n\n\n**Si la variable independiente es categórica (politómica)**\n============================================================\n  - Creo la variable categórica porque no existe en esta base de datos\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gtools)\ndataPAVI$tamaño = quantcut(dataPAVI$pctopo, q=3)\nlevels(dataPAVI$tamaño) = c(\"Bajo\",\"Medio\",\"Alto\")\n```\n:::\n\n\n## Dictomizo la variable categórica\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fastDummies)\ndataPAVI = dummy_cols(dataPAVI, select_columns = c( \"tamaño\"))\nnames(dataPAVI)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"poblacioncienmil\" \"nbi\"              \"consejocomunal\"   \"priorizado\"      \n [5] \"uribista\"         \"ejecucion\"        \"apropiaciondolar\" \"pctopo\"          \n [9] \"inversion\"        \"tamaño\"           \"tamaño_Bajo\"      \"tamaño_Medio\"    \n[13] \"tamaño_Alto\"      \"tamaño_NA\"       \n```\n:::\n:::\n\n\n  - HIPOTESIS: La asignación presupuestal se debe al tamaño de población de las comunas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo3 = lm(apropiaciondolar ~ tamaño_Bajo + tamaño_Medio, data = dataPAVI)\nsummary(modelo3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = apropiaciondolar ~ tamaño_Bajo + tamaño_Medio, \n    data = dataPAVI)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n -9.126  -8.507  -7.246   1.972 123.517 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    7.2463     0.8438   8.588   <2e-16 ***\ntamaño_Bajo    1.2609     1.1933   1.057    0.291    \ntamaño_Medio   1.8794     1.1933   1.575    0.116    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.08 on 1086 degrees of freedom\n  (7 observations deleted due to missingness)\nMultiple R-squared:  0.002367,\tAdjusted R-squared:  0.00053 \nF-statistic: 1.288 on 2 and 1086 DF,  p-value: 0.2761\n```\n:::\n:::\n\n\n\n\n**COMPARANDO LOS MODELOS**\n============================================================\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(stargazer)\ntabla = stargazer(modelo1,modelo2,modelo3, type = \"text\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n========================================================================================\n                                            Dependent variable:                         \n                    --------------------------------------------------------------------\n                                              apropiaciondolar                          \n                              (1)                     (2)                   (3)         \n----------------------------------------------------------------------------------------\nnbi                        -0.159***                                                    \n                            (0.026)                                                     \n                                                                                        \npriorizado1                                          -0.005                             \n                                                    (1.117)                             \n                                                                                        \ntamaño_Bajo                                                                1.261        \n                                                                          (1.193)       \n                                                                                        \ntamaño_Medio                                                               1.879        \n                                                                          (1.193)       \n                                                                                        \nConstant                   15.279***                8.277***              7.246***      \n                            (1.222)                 (0.561)               (0.844)       \n                                                                                        \n----------------------------------------------------------------------------------------\nObservations                 1,066                   1,096                 1,089        \nR2                           0.034                  0.00000                0.002        \nAdjusted R2                  0.033                   -0.001                0.001        \nResidual Std. Error    15.921 (df = 1064)      16.052 (df = 1094)    16.077 (df = 1086) \nF Statistic         37.247*** (df = 1; 1064) 0.00002 (df = 1; 1094) 1.288 (df = 2; 1086)\n========================================================================================\nNote:                                                        *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntabla = write.csv(tabla,\"tablaRegresion.csv\")\n#install.packages(\"jtools\")\nlibrary(jtools)\n#install.packages(\"ggstance\")\nlibrary(ggstance)\n#install.packages(\"broom.mixed\")\nlibrary(broom.mixed)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntestplot1 <- plot_summs(modelo1,modelo2,modelo3,legend.title=\"Determinantes de la asignación presupuestal\",scale = TRUE, robust = TRUE)\ntestplot1\n```\n\n::: {.cell-output-display}\n![](s12-ejercicio-semana12b_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n**Interpretación**:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "s12-ejercicio-semana12b_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}